# 1. 네트워크 시작

## 네트워크 구성도

### 홈 네트워크

홈 네트워크를 구성하는 주요 요소들

- 모뎀
- 공유기
- 단말 간에 물리적 연결

### 데이터 센터 네트워크

- 안정적이고 빠른 대용량 서비스 제공을 목표로 구성

- 안정적인 서비스 제공을 위해 다양한 이중화 기술을 사용해야 함

- 많은 서버와 서비스가 한 네트워크에 연결되어 있으므로 높은 통신량을 수용할 수 있어야 한다.(고속 이더넷 기술이 사용됨)

- 데이터 센터 네트워크 구성

  - 3계층 디자인

    Core <-> Aggregation <-> Access

  - 2계층 디자인

    Spine <-> Leaf - 서버간 통신이 늘어나는 최근 트래픽 경향을 지원하기 위해 제안

### 프로토콜

- 물리적 측면 - 데이터 전송 매체, 신호 규약, 회선 규격 등. 이더넷이 널리 쓰임
- 논리적 측면 - 장치들끼리 통신하기 위한 프로토콜 규격. TCP/IP가 널리 쓰임
- HTTP 프로토콜 - 문자 기반. 효율성은 비트 기반 프로토콜보다 떨어지지만 다양한 확장이 가능
- 프로토콜 스택 - TCP와 IP는 별도 계층에서 동작하는 프로토콜이지만 함께 사용. 이러한 프로토콜 묶음.



## OSI 7계층과 TCP/IP

### OSI 7계층

- 데이터 플로 계층(하위계층) - 1~4계층, 데이터를 상대방에게 잘 전달하는 역할
- 애플리케이션 계층(상위계층) - 5~6계층

#### 1계층(Physical Layer)

- 물리적 연결과 관련된 정보를 정의함.
- 주로 전기 신호를 전달하는 데 초점을 맞춤.
- 허브, 리피터, 케이블, 커넥터, 트랜시버, 탭 등이 해당

#### 2계층(Data Link Layer)

- 전기 신호를 모아 우리가 알아볼 수 있는 데이터 형태로 처리

- 주소 정보를 정의하고 정확한 주소로 통신이 되도록 하는 데 초점이 맞추어져 있음

- 출발지와 도착지 주소를 확인하고 내게 보낸 것이 맞는지, 도는 내가 처리해야 하는지에 대해 검사 후 데이터 처리를 수행

- 이더넷 기반 네트워크의 2계층에서는 에러를 탐지하는 역할만 수행.

- 플로 컨트롤(한 명과 통신하는 것이 아니라 동시에 여러 명과 통신이 가능하므로 받는 사람이 현재 데이터를 받을 수 있는지 확인하는 작업부터 하는 것)

- 네트워크 인터페이스 카드(랜카드)와 스위치가 해당

   네트워크 인터페이스 카드

  1. 전기 신호를 데이터 형태로 만듬
  2. 목적지 MAC주소와 출발지 MAC주소를 확인
  3. 네트워크 인터페이스 카드의 MAC주소를 확인
  4. 목적지 MAC 주소와 네트워크 인터페이스 카드가 갖고 있는 MAC 주소가 맞으면 데이터를 처리하고 다르면 데이터를 폐기함

    스위치

  - 단말이 어떤 MAC주소인지 연결된 포트는 어느 것인지 주소 습득 과정에서 알 수 있음
  - 해당 데이터를 기반으로 단말들이 통신할 때 포트를 적절히 필터링하고 정확한 포트로 포워딩해줌

- MAC주소라는 주소 체계를 갖고 있음

#### 3계층(Network Layer)

- IP주소와 같은 논리적인 주소가 정의

- MAC주소와 달리 사용자가 환경에 맞게 변경해 사용할 수 있음

- 네트워크 주소 부분과 호스트 주소 부분으로 나뉨.

- 네트워크 주소 정보를 이용해 자신이 속한 네트워크와 원격지 네트워크를 구분할 수 있고 원격지 네트워크를 가려면 어디로 가야하는지 경로를 지정할 수 있음.

- 라우터가 해당

  정의한 IP주소를 이해할 수 있음. IP 주소를 사용해 최적의 경로를 찾아주고 해당 경로로 패킷을 전송하는 역할을 함.

#### 4계층(Transport Layer)

- 패킷이 유실되거나 순서가 바뀌었을 때 바로잡아주는 역할
- 패킷을 분할할 때 패킷 헤더에 보내는 순서와 받는 순서를 적어 통신하므로 패킷이 유실되면 재전송을 요청할 수 있고 순서가 뒤바뀌더라도 바로잡을 수 있음.
- 시퀀스 번호 - 패킷에 보내는 순서를 명시한 것
- ACK 번호 - 받는 순서를 나타낸 것
- 로드 밸런서와 방화벽이 해당

#### 5계층(Session Layer)

- 양 끝단의 응용 프로세스가 연결을 성립하도록 도와주고 연결이 안정적으로 유지되도록 관리하고 작업 완료 후에는 연결을 끝는 역할
- TCP/IP 세션을 만들고 없애는 책임을 짐
- 에러로 중단된 통신에 대한 에러 복구와 재전송도 수행

#### 6계층(Presentation Layer)

- 표현 방식이 다른 애플리케이션이나 시스템 간의 통신을 돕기 위해 하나의 통일된 구문 형식으로 변환시키는 기능을 수행
- MIME 인코딩이나 암호화, 압축, 코드 변환과 같은 동작이 이 계층에서 이루어짐

#### 7계층(Application Layer)

- 애플리케이션 프로세스를 정의하고 애플리케이션 서비스를 수행
- 네트워크 소프트웨어의 UI부분이나 사용자 입출력 부분을 정의하는 것
- FTP, SMTP, HTTP, TELNET 등이 있음




## 인캡슐레이션과 디캡슐레이션

- 상위 계층에서 하위 계층으로 데이터를 보내면 물리 계층에서 전기 신호 형태로 네트워크를 통해 신호를 보냄.

- 받는 쪽에서는 다시 하위 계층에서 상위 계층으로 데이터를 보냄.

- 위와 같이 데이터를 보내는 과정을 인캡슐레이션, 받는 과정을 디캡슐레이션이라고 함

- 인캡슐레이션 - 애플리케이션에서 데이터를 데이터 플로 계층으로 내려보내면서 패킷에 데이터를 넣을 수 있도록 분할

- 디캡슐레이션

  1. 받은 전기 신호를 데이터 형태로 만들어 2계층으로 올려보냄
  2. 송신자가 작성한 2계층 헤더에 포함된 정보를 확인
  3. 2계층에 적힌 정보 중 목적지가 자신이 아니라면 자신에게 온 패킷이 아니므로 버림(랜카드 담당)
  4. 목적지가 자신이 맞다면 3계층으로 정보를 보냄.(2계층의 헤더 정보는 필요없으므로 벗겨내고 올림)
  5. 3계층의 헤더 정보를 확인해 자신에게 온 것인지 확인하고 4와 같은 처리
  6. 반복...

- 헤더에 반드시 포함되어야 하는 정보

  - 현재 계층에서 정의하는 정보 - OSI 7계층의 각 계층에서의 목적에 맞는 정보들이 포함.
  - 상위 프로토콜 지시자 - 프로토콜 스택은 상위 계층으로 올라갈수록 종류가 많아짐. 인캡슐레이션에서는 문제가 없지만 디캡슐레이션하는 목적지 쪽에서는 헤더에 아무 정보가 없으면 어떤 상위 프로토콜로 올려보내 주어야 할지 알 수 없기 때문에 지시자를 넣어야 함.

- MSS&MTU(데이터 크기 조절)

  애플리케이션에서 데이터를 만들어 보낼 때 데이터 플로 계층에서 네트워크 상황에 맞게 데이터를 잘 쪼개 상대방에게 전달함.

  MSS - 네트워크에서 수용할 수 있는 크기를 역산정해 데이터가 4계층으로 내려올 때 적절한 크기로 쪼개질 수 있도록 유도하는 해당 값을 말함. (4계층에서 가질 수 있는 최대 데이터 값)

  MTU - 네트워크에서 한 번에 보낼 수 있는 데이터 크기

  IP헤더와 TCP헤더의 표준 헤더 크기는 일반적으로 각각 20바이트이므로 일반 이더뎃인 경우, MSS 값을 1460바이트로 사용함.(일반적인 이더넷에서 수용할 수 있는 크기가 1500바이트임)