# 4. 액세스 회선을 통해 인터넷의 내부로

## ADSL 기술을 이용한 액세스 회선의 구조와 동작

### 인터넷의 기본은 가정이나 회사의 LAN과 같음

- 가정이나 회사의 네트워크 규모가 커진 것이 인터넷
- 회사나 가정의 LAN이라면 중계 장치 간의 거리가 수미터에서 수백미터 정도임 -> 인터넷은 가장 가까운 전화국에만 도착하려 해도 수 키로는 될 것이고 이더넷 케이블로 연결하기 어려움
- 경로표에 등록된 경로 정보에 기초하여 중계 대상을 판단한다는 기본 동작은 같지만, 경로표에 정보를 등록하는 부분이 다름 -> 인터넷의 라우터는 경로 정보가 10만 개 이상이나 등록되어 있으며, 정보가 시시각각 변하기 때문에 경로 등록을 자동화해야 함

### 사용자와 인터넷을 연결하는 액세스 회선

- 스위칭 허브와 라우터로 패킷을 중계하면 패킷은 목적지 서버를 향해 진행함. 그리고 인터넷 접속용 라우터를 경유하여 인터넷으로 나감
- 인터넷 접속용 라우터는 액세스 회선의 규칙에 따라 패킷 송신 동작을 실행함
- 액세스 회선은 인터넷과 가정이나 회사의 LAN을 연결하는 통신 회선을 말함. 대표적으로 ADSL이 있음

### ADSL 모델에서 패킷을 셀로 분할함

1. 클라이언트에서 패킷에 IP 헤더를 붙임
2. MAC 헤더를 붙여서 보냄
3. 인터넷 접속용 라우터에서 패킷 수신
4. 인터넷 접속용 라우터에서 IP 패킷 추출
5. PPP, PPPoE, MAC의 각 헤더를 붙여서 ADSL 모뎀에 보냄
6. ADSL 모뎀에서 패킷 수신
7. ATM 셀로 분할
8. 전기 신호로 변환하여 송출
9. DSLAM(전화국용 집합 모뎀)에서 전기 신호 수신
10. ATM 셀에 되돌려 송신
11. BAS(광대역 액세스 서버) 에서 ATM 셀 수신
12. 패킷의 형태로 되돌림
13. PPP 패킷 추출
14. 터널링용 헤더를 붙여 송신
15. 라우터(터널링용)에서 터널링의 패킷 수신
16. IP 패킷 추출
17. 인터넷 내부를 향해 송신

- 셀 - 맨 앞부분에 헤더(5바이트)를 갖고 있고, 그 뒤에 데이터(48바이트)가 이어지는 작은 디지털 데이터의 덩어리로, ATM이라는 통신 기술에 사용함
- 셀을 사용하는 상태로 두면 다른 설비와 매끄럽게 연대되어 개발 투자나 설비 투자를 줄일 수 있음

### ADSL은 변조 방식으로 셀을 신호화함

- LAN의 경우 사각형 신호를 이용해 0과 1을 나타내는 간단한 방식으로 디지털 데이터를 신호로 변환했지만, ADSL은 좀 더 복잡한 방법을 사용
- 사각형 신호는 파형이 뭉개지기 쉽고 거리가 떨어진 경우에 오류를 일으키기 쉬움. 또한 사각형 신호에는 낮은 주파수에서 높은 주파수까지 넓은 범위의 주파수가 포함되어 있음 -> 신호의 주파수가 높아지면 주위에 방사되는 잡음의 양이 증가하므로 주파수 폭이 넓을 경우에는 잡음을 제어하기가 어려워짐
- ADSL 모뎀은 완만한 파형(정현파)을 합성한 신호에 0과 1의 비트값을 대응시키는 기술을 사용하였는데, 이를 **변조 기술**이라고 함
- ADSL은 진폭 변조(ASK) 방식과 위상 변조(PSK)라는 방식을 결합한 직교 진폭 변소(QAM)라는 방식을 사용함
- ASK - 신호의 진폭의 크기에 따라 0과 1을 대응시킴, 단계를 늘리면 대응시키는 비트 수를 늘릴 수 있음. 예를 들어 4단계로 하면 가장 작은 진폭을 00, 두번째를 01, 세번째를 10, 네번째를 11 이런식으로..
- PSK - 파는 일주기만에 원래 모습으로 되돌아가므로 원을 한 바퀴 돌고 돌아오는 동작에 이것을 적용하여 각도를 나타내는데 이를 위상이라 함. 이 위상에 0과 1을 대응시키는 것이 위상 변조
- QAM - ASK와 PSK를 결합한 것으로, 신호의 진폭과 위상에 각각 비트를 대응시켜 한 개의 파에 대응시키는 비트 수를 늘려 속도를 높인것

### ADSL은 파를 많이 사용하여 고속화를 실현함

- 주파수가 서로 다른 파를 혼합하면 파를 합성할 수 있으며, 특정 주파수의 파만 통과시키는 필터 회로를 사용하면 주파수마다 파를 분리할 수 있음 -> 대응시키는 비트 수가 많아짐
- ADSL은 이 성질을 이용하여 다수의 파에 비트값을 대응시켜 고속화를 함(4.3125kHz씩 주파수를 다르게 한 수백 개의 파를 사용하여 각각의 파에 직교 진폭 변조에 의해 비트값을 대응시킴)
- 다운로드에 사용하는 높은 주파수의 파는 감쇠가 크고 잡음의 영향을 받기 쉬우므로 적은 비트 수만 지원하거나 전혀 사용할 수 없는 경유가 있음 -> 거리가 멀어질수록 이러한 경향이 강해지기 때문에 전화국에서 멀어지면 속도가 떨어짐
- 잡음이나 감쇠 등의 회선 특성은 전화 회선마다 전부 다르고, 시간에 따라 변화하기 때문에 ADSL에는 회선의 상태를 조사하여 사용할 파의 수나 각 파에 대응하는 비트 수를 판단하는 구조도 마련되어 있음 -> 트레이닝

### 스플리터의 역할

- ADSL 모뎀에서 전기 신호로 변환된 셀은 다음에 스플리터라는 장치에 들어감
- ADSL의 신호는 전화의 음성 신호와 섞여서 전화 회선에 함께 흘러감
- 스플리터가 일을 하는 것은 전화 회선에서 신호가 들어온 경우에 전화와 ADSL의 신호를 나누는 역할을 함
- 전화 회선에서 들어오는 신호는 전화 신호와 ADSL의 신호 둘이 다 혼합되어 있으므로 이것을 그대로 전화기에 흘리면 ADSL의 신호가 잡음이 되어 전화 음성을 듣기 어려워짐
- 스플리터는 전화기측에 흐르는 높은 주파수의 신호를 차단하여 전화기에는 전화의 신호만 흐르고, ADSL모뎀으로 향하는 신호는 그대로 흐르게 함


### 전화국까지의 여정

- 스플리터의 앞에는 전화 케이블을 꽂은 모듈형 커넥터가 있음
- 이곳을 통과하여 전화의 옥내 배선을 빠져나가면 건물 등의 경우에는 IDF나 MDF가 있음
- 이것을 지나가면 다음은 보안기로, 낙뢰와 같이 밖의 전화선에서 과대한 전류가 흘러들지 않도록 보호함

### 잡음의 영향

- 트위스트 페어 케이블을 흐르는 신호는 사각형 신호가 한개뿐이므로 이것이 변형되면 오류가 발생하지만, ADSL의 신호는 다수의 주파수로 나뉘어져 잡음과 주파수가 겹치는 신호만 영향을 받아 사용할 수 없게 됨 -> 사용할 수 있는 신호의 수가 감소하여 속도가 저하됨

### DSLAM을 통과하여 BAS에 도달

- 전화 케이블을 통해 전화국에 도착한 신호가 배선반과 스플리터를 통과하여 DSLAM에 도착하면 전기 신호가 디지털 데이터의 셀로 복원됨
- DSLAM이 신호의 파형을 읽어 진폭과 위상을 조사하고, 이것이 어느 비트 값에 대응하는지 판단하여 디지털 데이터로 복원
- 사용자측에 있는 ADSL 모뎀의 수신 동작과 같으나, 장소 차지와 동작 감시 등의 이유로 다수의 ADSL 모뎀에 해당하는 기능을 묶어 하나의 케이스에 넣은 DSLAM을 사용
- 사용자측의 ADSL 모뎀과 다르게 이더넷 대신에 ATM 인터페이스를 가진 것이 대부분 -> 패킷을 분할한 셀의 형태 그대로 후방의 라우터와 주고받음
- DSLAM을 나온 셀은 BAS라는 패킷 중계 장치에 도착함
- BAS에도 DSLAM과 같이 ATM 인터페이스가 있고, 셀을 수신함
- 셀로부터 원래의 패킷으로 복원되면서 BAS의 수신동작은 끝
- 이후 패킷의 맨 앞부분에 있는 MAC 헤더와 PPPoE헤더를 버리고 PPP헤더 이후의 부분을 추출
- 터널링용 헤더를 붙여 터널링의 출구를 향해 중계



## 광섬유를 이용한 액세스회선(FTTH)

- 광섬유는 이중 구조의 가는 섬유질의 투명한 재질로 만들어져 있으며, 안쪽에 있는 코어 부분 속에 광신호를 흘려 디지털 데이터를 전달함
- 등이 켜진 밝은 상태가 디지털 데이터의 1을 나타내고, 어두운 상태가 0을 나타냄
- 디지털 데이터에서 갑자기 광신호를 만들 수 없으므로 디지털 데이터를 전기 신호로 변환한 후 전기 신호를 광신호로 변환

### 싱글모드와 멀티모드의 차이

- 광원에서 나온 빛은 구석구석까지 흩어지므로 코어 부분에는 여러 각도의 빛이 들어감
- 그러나 입사각이 큰 것은 코어와 클래드의 경계면에서 굴절되어 밖으로 나가버림
- 빛은 파의 일종이므로 같은 위상이 있고 코어와 클래드의 경계면에서 반사할 때 각도에 따라 위상차가 생긴다는 성질이 있음 -> 경계면을 향해 빛과 경계면에서 반사되어 돌아온 빛이 교차할 때 양쪽에 있는 빛의 위상차가 생기는 경우와 생기지 않는 경우로 나뉨
- 광섬유에 입사하는 빛은 각도가 다양한데, 그 중에서 반사될 때 위상이 같은 각도로 입사된 소수의 빛만이 멀리 도달함. 코어의 직경은 이 각도를 고려하여 결정되어 있음
- 코어는 싱글모드(8~10마이크로미터)와 멀티모드(50 또는 62.5 마이크로미터)가 있음
- 싱글모드 - 코어가 가늘고 입사각이 작은 빛만 속으로 들어가므로 위상이 같은 각도 중 가장 작은 각도의 빛만 들어갈 수 있음(위상이 같은 각도 중에서 가장 각도가 작은 빛만 들어가도록 코어의 직경을 가늘게 만든 것)
- 멀티모드 - 코어의 직경이 굵고 입사각이 큰 빛도 들어가므로 위상이 같은 각도 중에서 가장 작은 것뿐만 아니라 두 번째로 작은 것, 세 번째로 작은 것과 같이 복수의 빛이 코어 속으로 진행함
- 멀티모드는 신호가 도착하는 시간이 일정하지 않아 신호의 폭이 넓어지는데, 이것은 신호가 변형된다는 것을 의미하고 광섬유가 길어짐에 따라 변형이 커지고 허용 한도를 초과하면 통신 오류를 일으킴

### 광섬유를 분기시켜서 비용을 절감함

- ADSL 대신 광섬유를 사용하여 사용자측의 인터넷 접속용 라우터와 인터넷 측의 BAS를 접속하는 것이 FTTH 액세스 회선
- 한 개의 광섬유로 사용자측과 가장 가까운 전화국측을 접속하는 유형 - 사용자 측에 설치딘 미디어 컨버터라는 장치에서 이더넷의 전기 신호를 광신호로 변환 -> 광섬유를 통해 BAS 앞의 미디어 컨버터에 도착 후 전기 신호로 복원되어 BAS의 포트가 수신하고 인터넷의 내부로 패킷을 중계함
- 파장 다중 - 한 개의 광섬유를 사용하여 파장이 서로 다른 복수의 광신호를 흘리는 것
- 여러 개의 광섬유로 분기하여 가장 가까운 전화국측을 접속하는 유형 - 광섬유를 분기시키는 광스플리터를 사용자 근처의 전주에 설치하는 방법과 가장 가까운 전화국에 설치하는 두 가지 방법이 있음
- 미디어 컨버터 대신 ONU라는 장치를 사용하여 이더넷 신호를 광신호로 변환하고, BAS앞에는 OLT라는 장치를 두어 전기신호로 변환함. 복수의 사용자가 동시에 패킷 송신 동작을 하면 광스플리터 부분에서 패킷의 광신호가 충돌하기에 타이밍을 조절하는 기능이 마련되어 있음



## 액세스 회선을 이용하는 PPP와 터널링



