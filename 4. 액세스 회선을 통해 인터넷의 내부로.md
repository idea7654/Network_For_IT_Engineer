# 4. 액세스 회선을 통해 인터넷의 내부로

## ADSL 기술을 이용한 액세스 회선의 구조와 동작

### 인터넷의 기본은 가정이나 회사의 LAN과 같음

- 가정이나 회사의 네트워크 규모가 커진 것이 인터넷
- 회사나 가정의 LAN이라면 중계 장치 간의 거리가 수미터에서 수백미터 정도임 -> 인터넷은 가장 가까운 전화국에만 도착하려 해도 수 키로는 될 것이고 이더넷 케이블로 연결하기 어려움
- 경로표에 등록된 경로 정보에 기초하여 중계 대상을 판단한다는 기본 동작은 같지만, 경로표에 정보를 등록하는 부분이 다름 -> 인터넷의 라우터는 경로 정보가 10만 개 이상이나 등록되어 있으며, 정보가 시시각각 변하기 때문에 경로 등록을 자동화해야 함

### 사용자와 인터넷을 연결하는 액세스 회선

- 스위칭 허브와 라우터로 패킷을 중계하면 패킷은 목적지 서버를 향해 진행함. 그리고 인터넷 접속용 라우터를 경유하여 인터넷으로 나감
- 인터넷 접속용 라우터는 액세스 회선의 규칙에 따라 패킷 송신 동작을 실행함
- 액세스 회선은 인터넷과 가정이나 회사의 LAN을 연결하는 통신 회선을 말함. 대표적으로 ADSL이 있음

### ADSL 모델에서 패킷을 셀로 분할함

1. 클라이언트에서 패킷에 IP 헤더를 붙임
2. MAC 헤더를 붙여서 보냄
3. 인터넷 접속용 라우터에서 패킷 수신
4. 인터넷 접속용 라우터에서 IP 패킷 추출
5. PPP, PPPoE, MAC의 각 헤더를 붙여서 ADSL 모뎀에 보냄
6. ADSL 모뎀에서 패킷 수신
7. ATM 셀로 분할
8. 전기 신호로 변환하여 송출
9. DSLAM(전화국용 집합 모뎀)에서 전기 신호 수신
10. ATM 셀에 되돌려 송신
11. BAS(광대역 액세스 서버) 에서 ATM 셀 수신
12. 패킷의 형태로 되돌림
13. PPP 패킷 추출
14. 터널링용 헤더를 붙여 송신
15. 라우터(터널링용)에서 터널링의 패킷 수신
16. IP 패킷 추출
17. 인터넷 내부를 향해 송신

- 셀 - 맨 앞부분에 헤더(5바이트)를 갖고 있고, 그 뒤에 데이터(48바이트)가 이어지는 작은 디지털 데이터의 덩어리로, ATM이라는 통신 기술에 사용함
- 셀을 사용하는 상태로 두면 다른 설비와 매끄럽게 연대되어 개발 투자나 설비 투자를 줄일 수 있음

### ADSL은 변조 방식으로 셀을 신호화함

- LAN의 경우 사각형 신호를 이용해 0과 1을 나타내는 간단한 방식으로 디지털 데이터를 신호로 변환했지만, ADSL은 좀 더 복잡한 방법을 사용
- 사각형 신호는 파형이 뭉개지기 쉽고 거리가 떨어진 경우에 오류를 일으키기 쉬움. 또한 사각형 신호에는 낮은 주파수에서 높은 주파수까지 넓은 범위의 주파수가 포함되어 있음 -> 신호의 주파수가 높아지면 주위에 방사되는 잡음의 양이 증가하므로 주파수 폭이 넓을 경우에는 잡음을 제어하기가 어려워짐
- ADSL 모뎀은 완만한 파형(정현파)을 합성한 신호에 0과 1의 비트값을 대응시키는 기술을 사용하였는데, 이를 **변조 기술**이라고 함
- ADSL은 진폭 변조(ASK) 방식과 위상 변조(PSK)라는 방식을 결합한 직교 진폭 변소(QAM)라는 방식을 사용함
- ASK - 신호의 진폭의 크기에 따라 0과 1을 대응시킴, 단계를 늘리면 대응시키는 비트 수를 늘릴 수 있음. 예를 들어 4단계로 하면 가장 작은 진폭을 00, 두번째를 01, 세번째를 10, 네번째를 11 이런식으로..
- PSK - 파는 일주기만에 원래 모습으로 되돌아가므로 원을 한 바퀴 돌고 돌아오는 동작에 이것을 적용하여 각도를 나타내는데 이를 위상이라 함. 이 위상에 0과 1을 대응시키는 것이 위상 변조
- QAM - ASK와 PSK를 결합한 것으로, 신호의 진폭과 위상에 각각 비트를 대응시켜 한 개의 파에 대응시키는 비트 수를 늘려 속도를 높인것

### ADSL은 파를 많이 사용하여 고속화를 실현함

- 주파수가 서로 다른 파를 혼합하면 파를 합성할 수 있으며, 특정 주파수의 파만 통과시키는 필터 회로를 사용하면 주파수마다 파를 분리할 수 있음 -> 대응시키는 비트 수가 많아짐
- ADSL은 이 성질을 이용하여 다수의 파에 비트값을 대응시켜 고속화를 함(4.3125kHz씩 주파수를 다르게 한 수백 개의 파를 사용하여 각각의 파에 직교 진폭 변조에 의해 비트값을 대응시킴)
- 다운로드에 사용하는 높은 주파수의 파는 감쇠가 크고 잡음의 영향을 받기 쉬우므로 적은 비트 수만 지원하거나 전혀 사용할 수 없는 경유가 있음 -> 거리가 멀어질수록 이러한 경향이 강해지기 때문에 전화국에서 멀어지면 속도가 떨어짐
- 잡음이나 감쇠 등의 회선 특성은 전화 회선마다 전부 다르고, 시간에 따라 변화하기 때문에 ADSL에는 회선의 상태를 조사하여 사용할 파의 수나 각 파에 대응하는 비트 수를 판단하는 구조도 마련되어 있음 -> 트레이닝

### 스플리터의 역할

- ADSL 모뎀에서 전기 신호로 변환된 셀은 다음에 스플리터라는 장치에 들어감
- ADSL의 신호는 전화의 음성 신호와 섞여서 전화 회선에 함께 흘러감
- 스플리터가 일을 하는 것은 전화 회선에서 신호가 들어온 경우에 전화와 ADSL의 신호를 나누는 역할을 함
- 전화 회선에서 들어오는 신호는 전화 신호와 ADSL의 신호 둘이 다 혼합되어 있으므로 이것을 그대로 전화기에 흘리면 ADSL의 신호가 잡음이 되어 전화 음성을 듣기 어려워짐
- 스플리터는 전화기측에 흐르는 높은 주파수의 신호를 차단하여 전화기에는 전화의 신호만 흐르고, ADSL모뎀으로 향하는 신호는 그대로 흐르게 함


### 전화국까지의 여정

- 스플리터의 앞에는 전화 케이블을 꽂은 모듈형 커넥터가 있음
- 이곳을 통과하여 전화의 옥내 배선을 빠져나가면 건물 등의 경우에는 IDF나 MDF가 있음
- 이것을 지나가면 다음은 보안기로, 낙뢰와 같이 밖의 전화선에서 과대한 전류가 흘러들지 않도록 보호함

### 잡음의 영향

- 트위스트 페어 케이블을 흐르는 신호는 사각형 신호가 한개뿐이므로 이것이 변형되면 오류가 발생하지만, ADSL의 신호는 다수의 주파수로 나뉘어져 잡음과 주파수가 겹치는 신호만 영향을 받아 사용할 수 없게 됨 -> 사용할 수 있는 신호의 수가 감소하여 속도가 저하됨

### DSLAM을 통과하여 BAS에 도달

- 전화 케이블을 통해 전화국에 도착한 신호가 배선반과 스플리터를 통과하여 DSLAM에 도착하면 전기 신호가 디지털 데이터의 셀로 복원됨
- DSLAM이 신호의 파형을 읽어 진폭과 위상을 조사하고, 이것이 어느 비트 값에 대응하는지 판단하여 디지털 데이터로 복원
- 사용자측에 있는 ADSL 모뎀의 수신 동작과 같으나, 장소 차지와 동작 감시 등의 이유로 다수의 ADSL 모뎀에 해당하는 기능을 묶어 하나의 케이스에 넣은 DSLAM을 사용
- 사용자측의 ADSL 모뎀과 다르게 이더넷 대신에 ATM 인터페이스를 가진 것이 대부분 -> 패킷을 분할한 셀의 형태 그대로 후방의 라우터와 주고받음
- DSLAM을 나온 셀은 BAS라는 패킷 중계 장치에 도착함
- BAS에도 DSLAM과 같이 ATM 인터페이스가 있고, 셀을 수신함
- 셀로부터 원래의 패킷으로 복원되면서 BAS의 수신동작은 끝
- 이후 패킷의 맨 앞부분에 있는 MAC 헤더와 PPPoE헤더를 버리고 PPP헤더 이후의 부분을 추출
- 터널링용 헤더를 붙여 터널링의 출구를 향해 중계



## 광섬유를 이용한 액세스회선(FTTH)

- 광섬유는 이중 구조의 가는 섬유질의 투명한 재질로 만들어져 있으며, 안쪽에 있는 코어 부분 속에 광신호를 흘려 디지털 데이터를 전달함
- 등이 켜진 밝은 상태가 디지털 데이터의 1을 나타내고, 어두운 상태가 0을 나타냄
- 디지털 데이터에서 갑자기 광신호를 만들 수 없으므로 디지털 데이터를 전기 신호로 변환한 후 전기 신호를 광신호로 변환

### 싱글모드와 멀티모드의 차이

- 광원에서 나온 빛은 구석구석까지 흩어지므로 코어 부분에는 여러 각도의 빛이 들어감
- 그러나 입사각이 큰 것은 코어와 클래드의 경계면에서 굴절되어 밖으로 나가버림
- 빛은 파의 일종이므로 같은 위상이 있고 코어와 클래드의 경계면에서 반사할 때 각도에 따라 위상차가 생긴다는 성질이 있음 -> 경계면을 향해 빛과 경계면에서 반사되어 돌아온 빛이 교차할 때 양쪽에 있는 빛의 위상차가 생기는 경우와 생기지 않는 경우로 나뉨
- 광섬유에 입사하는 빛은 각도가 다양한데, 그 중에서 반사될 때 위상이 같은 각도로 입사된 소수의 빛만이 멀리 도달함. 코어의 직경은 이 각도를 고려하여 결정되어 있음
- 코어는 싱글모드(8~10마이크로미터)와 멀티모드(50 또는 62.5 마이크로미터)가 있음
- 싱글모드 - 코어가 가늘고 입사각이 작은 빛만 속으로 들어가므로 위상이 같은 각도 중 가장 작은 각도의 빛만 들어갈 수 있음(위상이 같은 각도 중에서 가장 각도가 작은 빛만 들어가도록 코어의 직경을 가늘게 만든 것)
- 멀티모드 - 코어의 직경이 굵고 입사각이 큰 빛도 들어가므로 위상이 같은 각도 중에서 가장 작은 것뿐만 아니라 두 번째로 작은 것, 세 번째로 작은 것과 같이 복수의 빛이 코어 속으로 진행함
- 멀티모드는 신호가 도착하는 시간이 일정하지 않아 신호의 폭이 넓어지는데, 이것은 신호가 변형된다는 것을 의미하고 광섬유가 길어짐에 따라 변형이 커지고 허용 한도를 초과하면 통신 오류를 일으킴

### 광섬유를 분기시켜서 비용을 절감함

- ADSL 대신 광섬유를 사용하여 사용자측의 인터넷 접속용 라우터와 인터넷 측의 BAS를 접속하는 것이 FTTH 액세스 회선
- 한 개의 광섬유로 사용자측과 가장 가까운 전화국측을 접속하는 유형 - 사용자 측에 설치딘 미디어 컨버터라는 장치에서 이더넷의 전기 신호를 광신호로 변환 -> 광섬유를 통해 BAS 앞의 미디어 컨버터에 도착 후 전기 신호로 복원되어 BAS의 포트가 수신하고 인터넷의 내부로 패킷을 중계함
- 파장 다중 - 한 개의 광섬유를 사용하여 파장이 서로 다른 복수의 광신호를 흘리는 것
- 여러 개의 광섬유로 분기하여 가장 가까운 전화국측을 접속하는 유형 - 광섬유를 분기시키는 광스플리터를 사용자 근처의 전주에 설치하는 방법과 가장 가까운 전화국에 설치하는 두 가지 방법이 있음
- 미디어 컨버터 대신 ONU라는 장치를 사용하여 이더넷 신호를 광신호로 변환하고, BAS앞에는 OLT라는 장치를 두어 전기신호로 변환함. 복수의 사용자가 동시에 패킷 송신 동작을 하면 광스플리터 부분에서 패킷의 광신호가 충돌하기에 타이밍을 조절하는 기능이 마련되어 있음





## 액세스 회선을 이용하는 PPP와 터널링

### 본인 확인과 설정 정보를 통지함

- ADSL이나 FTTH등의 액세스 회선에서 인터넷을 향해 흘러온 패킷은 액세스 회선을 운영하는 사업자가 소유한 BAS에 도착함
- 인터넷은 원래 다수의 라우터를 함께 연결하여 만든 것이므로 액세스 회선을 라우터에 연결하는 것이 원칙 -> 라우터가 진화한 것이 BAS
- BAS는 본인확인과 설정값 통지 기능이 있는 라우터.
- ADSL이나 FTTH의 액세스 회선은 최초에 사용자명과 패스워드를 입력하여 로그인 동작을 실행하지 않으면 인터넷에 액세스할 수 없음
- 이 때 BAS는 로그인 동작의 창구 역할이 되며, 이를 위해 PPPoE라는 구조를 사용함
- PPP의 동작
  1. 프로바이더의 액세스 포인터에 접속 명령을 통해 인증서버(RAS)와 회선이 접속됨
  2. LCP에서 구성 정보를 교환함(최대 패킷 길이, 인증 프로토콜 등)
  3. PAP/CHAP에 의한 본인 확인(사용자명과 패스워드 확인)
  4. IPCP에 의한 TCP/IP의 설정 정보를 통지(IP 주소 등의 할당)
  5. CCP에 의한 압축 기능의 정보 교환
  6. 데이터 패킷 송수신

### 이더넷에서 PPP 메시지를 주고받는 PPPoE

- ADSL이나 FTTH도 PC에 글로벌 주소를 설정하지 않으면 인터넷에 접속할 수 없음
- 그러나 ADSL이나 FTTH는 사용자와 BAS를 케이블로 고정적으로 접속하므로 본인인지 확인할 필요가 없음
- 다라서 PPP의 구조가 전부 필요한 것은 아니고, 사용자명과 패스워드를 입력하는 동작을 남겨두면 사용자명에 따라 프로바이더를 전환할 수 있음
- PPP의 메시지를 운반할 때는 IP 패킷을 이더넷의 패킷에 넣어 운반하는 것과 같은 개념이 필요함
- PPP를 이더넷 사양에 맞게 새로 만든 사양이 PPPoE

### 터널링 기능에 의해 프로바이더에 패킷을 전달함

- BAS에는 본인 확인의 역할을 하는 기능과 함게 터널링을 통해 패킷을 운반하는 역할도 함
- 터널링 - 한쪽의 터널링 출입구에서 헤더를 포함한 패킷 전체를 넣으면 이것이 헤더를 포함하여 그대로의 모습으로 반대쪽 출입구에 도달함
- 이를 이용하여 BAS와 프로바이더의 라우터 사이에 있는 ADSL/FTTH 접속 서비스 사업자의 네트워크 안에 터널을 만듬
- 여기에 사용자와 BAS를 연결하는 액세스 회선을 연결하면 프로바이더의 라우터까지 한 개의 길이 만들어져 패킷이 그 길을 통해 인터넷의 내부로 들어감

### 액세스 회선 전체의 동작

액세스 회선의 동작은 사용자측에 인터넷 접속용 라우터를 설치하고 인터넷에 접속한 곳부터 시작됨

1. 인터넷 접속용 라우터에 프로바이더가 할당한 사용자명과 패스워드를 등록하면 인터넷 접속용 라우터는 PPPoE의 Discovery라는 구조에 따라 BAS를 찾음
2. Discovery의 구조는  ARP와 마찬가지로 인터넷의 브로드캐스트를 이용한 것
3. BAS의 MAC주소를 알아내어 BAS와 연결
4. 사용자명과 패스워드를 BAS에 보냄(암호화하는 CHAP방식과 암호화하지 않는 PAP방식)
5. 패스워드를 확인한 후 BAS에서 사용자에 대해 TCP/IP의 설정정보를 통지(인터넷 기기에 할당한 IP 주소, DNS 서버의 IP주소, 기본 게이트웨이의 IP주소, 인터넷 접속용 라우터를 사용할 경우에는 이 설정 정보를 인터넷 접속용 라우터가 받아서 라우터 자체에 설정)
6. 인터넷 접속용 라우터의 BAS측 포트에 글로벌 주소가 할당되고, 경로표에 기본 게이트웨이도 설정됨
7. 인터넷 접속용 라우터는 패킷을 인터넷에 중계할 수 있는 상태가 됨(준비동작 완료)
8. 클라이언트로부터 인터넷에 액세스하면 패킷이 흘러옴
9. 패킷의 수신처는 인터넷의 어느 한 부분이므로 인터넷 접속용 라우터의 경로표에 등록되어있지 않을 확률이 큼
10. 이 경우 인터넷 접속용 라우터는 기본 경로를 채택하여 여기에 등록되어 있는 게이트웨이, 즉 BAS에서 통지된 기본 게이트웨이에 패킷을 중계
11. 송신하는 패킷에 MAC헤더, PPPoE헤더, PPP헤더를 붙이고 값을 기록
12. MAC헤더에는 PPPoE의 Discovery에서 조사한 BAS의 MAC주소를, 이더 타입에는 PPPoE를 나타내는 8864를 입력
13. 패킷을 신호로 변환하여 포트에서 송신함
14. 패킷이 BAS에 도착하여 MAC헤더와 PPPoE헤더를 제거하고, PPP 헤더 이후의 부분을 추출한 후 터널링의 원리를 이용하여 패킷을 송신함
15. 프로바이더의 라우터에 도착

### IP 어드레스를 할당하지 않는 언넘버드

- 인터넷 접속용 라우터가 패킷을 송신할 때 부가하는 헤더의 값은 사전에 대부분 결정되어 있어서 경로표의 기본 게이트웨이 항목에 어떤 값이 들어와도 관계가 없음
- 라우터의 포트끼리 하나의 케이블로 연결하는 상태에서 접속되어 있는 부분에서는 한쪽에서 송신한 패킷은 반드시 반대편에 도착하므로 경로표에서 게이트웨이 항목의 값을 바탕으로 중계 대상의 주소를 조사하는 동작은 필요없음
- 중계 대상의 주소를 조사할 필요가 없으면 게이트웨이 항목에 값을 기록할 필요가 없음. -> 게이트웨이 항목에 주소를 기록할 필요가 없으면 중계 대상 라우터의 포트에 IP주소를 할당할 필요도 없음
- 이러한 경우 BAS에서 설정 정보를 통지하므로 기본 게이트웨이의 IP주소를 통지하지 않음

### 인터넷 접속용 라우터에서 프라이비트 주소를 글로벌 주소로 변환

- BAS는 사용자측에 TCP/IP의 설정 정보를 통지함
- 이 설정 정보를 PC에 설정하면 글로벌 주소가 할당되어 주소 변환의 원리를 사용하지 않고 인터넷에 액세스할 수 있는데, 이것이 TCP/IP 본래 방법
- 그러나 인터넷 접속용 라우터를 사용하면 BAS가 통지한 설정 정보를 라우터가 받아버려서 글로벌 주소는 라우터에 할당되어버림 -> PC에 글로벌 주소를 할당할 수 없음
- 이 경우 PC에는 프라이비트 주소를 할당하고 PC가 보낸 패킷은 인터넷 접속용 라우터에서 주소 변환한 후 인터넷에 중계됨

### PPPoE 이외의 방식

#### PPPoA

- ADSL에서 PPPoE를 이용할 때는 PPP 메시지를 일단 이더넷의 패킷에 저장한 후 셀에 저장했지만, PPPoA는 PPP메시지를 그대로 셀에 저장함
- 맨 앞에 MAC 헤더가 붙어있지 않으므로 PPP 메시지를 그대로 이더넷에 전송할 수 있음
- PPP메시지는 이더넷에 그냥 전송할 수 없으므로 BAS와PPP메시지를 주고받는 기기, 즉 PC나 라우터를 ADSL 모뎀과 일체화하지 않으면 PPP의 구조가 동작하지 않음
- 일체화하는 방식
  - PC의 USB인터페이스에 ADSL모뎀을 연결하여 ADSL 모뎀과 PC를 일체화하는 방법 - 보급안됨
  - ADSL모뎀과 라우터를 일체화시킨 라우터 일체형 ADSL 모뎀을 사용하는 방법 -> 주소 변환에서 문제가 발생하면 곤란해짐
- MTU가 짧아짐

### DHCP

- 주로 사내 LAN에서 클라이언트 PC에 TCP/IP의 설정 정보를 통지하기 위해 널리 사용됨
- PC에서 설정 정보를 요구하고 DHCP 서버가 설정 정보를 통지만 하는 간단한 것
- ADSL 모뎀의 방식도 PPPoE나 PPPoA와는 달리 셀을 사용하지 않고 이더넷 패킷을 그대로 ADSL 신호로 변환함
- ADSL 모뎀과 라우터를 분리할 수 없다는 제약도 없음



## 프로바이더의 내부

### POP와 NOC

- 액세스 회선을 통과한 패킷은 프로바이더의 라우터에 도착함. 여기서부터 패킷은 인터넷의 내부로 들어감

- 인터넷의 실체는 한 개의 조직이 운영 관리하는 단일 네트워크가 아니라 다수의 프로바이더의 네트워크를 서로 접속한 것

- ADSL이나 FTTH의 액세스 회선은 사용자가 계약한 프로바이더의 설비에 연결되어 있는데, 이 설비를 POP라고 함. 인터넷의 입구인 라우터는 여기 설치

- POP의 구조

  - 액세스 회로가 전용 접속 회선일 경우

    사용자 -> 전용선 -> POP의 라우터 -> POP의 스위치 -> POP의 라우터 -> NOC또는 기타 POP

  - 액세스 회로가 다이얼업 접속일 경우

    사용자 -> 전화/ISDN -> RAS -> POP의 스위치 -> POP의 라우터 -> NOC 또는 기타 POP

  - 액세스 회로가 PPP프로토콜을 사용할 경우

    사용자 -> PPPoE용/FTTH용 BAS -> POP의 라우터 -> POP의 스위치 -> POP의 라우터 -> NOC 또는 기타 POP

  - 액세스 회로가 PPPoA를 사용할 경우

    사용자 -> DSLAM -> ATM스위치(셀을 중계하기 위한 장치) -> BAS -> POP라우터 -> POP 스위치 -> POP라우터 -> NOC 또는 기타 POP

- NOC - 프로바이더의 핵심이 되는 설비로서 POP에서 들어온 패킷이 여기에 모여듬. 이곳에서 목적지 근처에 있는 POP나 다른 프로바이더로 패킷이 흘러감(매우 고사양)

- NOC와 POP는 엄밀하게 구분할 수 없음. 기본 동작은 모든 라우터에서 차이가 없기 때문에 POP의 규모가 큰 것이 NOC

### 건물 밖은 통신 회선 등으로 접속

- 통신회선 - 광섬유를 소유하고 있는 회사에서 광섬유를 세분화하고 그 일부를 빌려주고 수입을 얻는 사업에서 제공하는 서비스
- 광섬유를 갖고 있지 않은 프로바이더는 이 통신 회선을 사용하여 멀리 떨어진 장소에 있는 NOC나 POP를 연결함



## 프로바이더를 경유하여 흐르는 패킷

### 프로바이더끼리의 접속

- 프로바이더의 라우터에는 라우터끼리 경로 정보를 교환하고, 이것을 경로표에 자동으로 등록함
- 이 동작을 반복하면 패킷은 서버측의 POP에 설치한 라우터에 도착하고, 서버를 향함

### 프로바이더끼리 경로 정보 교환하기

- BGP - 상대가 경로 정보를 가르쳐주면 그곳에 어떤 네트워크가 있는지 알 수 있게 되고 이쪽에서도 같은 방법으로 상대에게 경로 정보를 통지. 이 경로 정보 교환은 라우터가 자동적으로 수행하고, 여기에서 사용하는 구조

- BGP는 두 가지 유형으로 나눌 수 있음

  - 인터넷의 경로를 전부 상대에게 통지하는 방식

    transit - 프로바이더 D가 E에 대해 인터넷의 경로를 전부 통지한다고 가정하면, E는 D가 아니라 그 앞에 있는 프로바이더 A, B, C 등 인터넷에 있는 프로바이더가 전부 볼 수 있게 됨. 그 결과, 인터넷의 모든 패킷이 프로바이더 D를 통과하여 흐름

  - 두 프로바이더가 각각의 네트워크에 관한 경로 정보만 상대에게 통지하는 방식

    서로 상대의 네트워크로 갈 패킷만 흐르게 되는데, 이 방법을 **비트랜지트** 또는 **피어**라고 함

### 사내 네트워크에서 자동 등록하기

- 사내에서 사용하는 라우터의 구조는 목적지까지의 최단 경로를 찾아 거기에 패킷을 중계하도록 만들어져 있음
- 따라서 주변에 있는 전체 라우터와 무차별적으로 경로 정보를 교환함
- 사내 라우터는 무차별적으로 모든 라우터와 경로 정보를 교환하지만, 프로바이더 간의 경로 정보 교환은 특정 라우터와 1대1로 이루어짐 -> 무임승차를 막기 위해
- 따라서 프로바디어간의 경로 중계에는 최단 경로 이외에도 상대를 선택하여 경로 정보를 교환하는 방법을 사용

### IX의 필요성

- 프로바이더끼리 접속하는 방법은 프로바이더끼리 1대1 형태로 접속하는 것이 기본
- 그러나, 프로바이더끼리 1대1로 접속하는 방법밖에 없으면 모든 프로바이더와 통신 회선을 연결해야 함
- 이 때, 중심이 되는 설비를 설치하고, 이것을 경유하여 접속하는 방법을 선택하면 통신 회선의 수를 억제할 수 있음. 이 장비가 IX

### IX에서 프로바이더끼리 접속하는 모습

- IX는 정전이나 화재 등의 사고나 지진 등의 재해가 있어도 라우터의 네트워크 기기가 정지하지 않도록 자가 발전 설비를 갖춘 내진 구조의 건물 안에 있음
- 프로바이더나 IX 운영 조직은 건물의 입주자로서 공간을 빌려 NOC나 IX의 설비를 설치운영하고 있음. 즉, 건물 어딘가에 IX가 있고, IX의 중심에는 고속 LAN의 인터페이스를 다수 장착한 레이더2 스위치가 있음
- 여기에 프로바이더의 라우터를 연결
- 최근에는 데이터센터 등 패킷의 흐름이 집중되는 장소에 IX의 목적지가 되는 스위치를 설치하고, 여기에 프로바이더의 라우터를 가지고 연결하는 예가 늘고 있음
- IX의 스위치는 스위칭 허브와 같이 동작하므로 라우터에서 패킷을 송신할 때 ARP에서 중계 대상 라우터의 인터페이스의 MAC 주소를 조사하여 이것을 MAC 헤더에 기록한 후 패킷을 보내는 것 뿐(무임승차 막기 위해 선택된 것들과만)